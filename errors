C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:5:1: error: stray '@' in program
    5 | @@ -16,97 +16,97 @@
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:5:2: error: stray '@' in program
    5 | @@ -16,97 +16,97 @@
      |  ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:5:18: error: stray '@' in program
    5 | @@ -16,97 +16,97 @@
      |                  ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:5:19: error: stray '@' in program
    5 | @@ -16,97 +16,97 @@
      |                   ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:1:1: error: 'diff' does not name a type
    1 | diff --git a/CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino b/CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino
      | ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:17:38: error: 'Adafruit_MPU6050' does not name a type
   17 |  CRGB leds[NUM_FACES][NUM_LEDS_FACE];Adafruit_MPU6050 mpu;Preferences prefs;AsyncWebServer server(80);AsyncWebSocket ws("/ws");
      |                                      ^~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:17:59: error: 'Preferences' does not name a type
   17 |  CRGB leds[NUM_FACES][NUM_LEDS_FACE];Adafruit_MPU6050 mpu;Preferences prefs;AsyncWebServer server(80);AsyncWebSocket ws("/ws");
      |                                                           ^~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:17:77: error: 'AsyncWebServer' does not name a type
   17 |  CRGB leds[NUM_FACES][NUM_LEDS_FACE];Adafruit_MPU6050 mpu;Preferences prefs;AsyncWebServer server(80);AsyncWebSocket ws("/ws");
      |                                                                             ^~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:17:103: error: 'AsyncWebSocket' does not name a type
   17 |  CRGB leds[NUM_FACES][NUM_LEDS_FACE];Adafruit_MPU6050 mpu;Preferences prefs;AsyncWebServer server(80);AsyncWebSocket ws("/ws");
      |                                                                                                       ^~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:31:1: error: expected unqualified-id before '-' token
   31 | -struct FaceConfig{Pattern pattern;Params params;};
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:32:1: error: expected unqualified-id before '+' token
   32 | +struct FaceConfig{Pattern pattern;Params params;uint8_t rotation;};
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:35:1: error: expected unqualified-id before '-' token
   35 | -struct PresetB{uint8_t p;Params pr;uint8_t ovr,oPat,blend,oA;};
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:36:1: error: expected unqualified-id before '-' token
   36 | -struct PresetG{uint8_t p;Params pr;uint8_t ovr,oPat,blend,oA;String name;};
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:37:1: error: expected unqualified-id before '+' token
   37 | +struct PresetB{uint8_t p;Params pr;uint8_t ovr,oPat,blend,oA;uint8_t rot[NUM_FACES];};
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:38:1: error: expected unqualified-id before '+' token
   38 | +struct PresetG{uint8_t p;Params pr;uint8_t ovr,oPat,blend,oA;uint8_t rot[NUM_FACES];String name;};
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:96:1: error: 'CRGB' does not name a type
   96 |  CRGB chsvMix(uint8_t h,uint8_t s,uint8_t v){return CHSV(h,s,v);}
      | ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:97:1: error: 'CRGB' does not name a type
   97 |  CRGB overlayPixel(uint8_t face,uint16_t idx){switch(ovrPattern){case PATTERN_SOLID:{uint8_t h=ovcUse?g_oh:liveParams.hue;uint8_t s=ovcUse?g_os:liveParams.sat;uint8_t v=ovcUse?g_ov:liveParams.val;return chsvMix(h,s,v);}case PATTERN_BAND:{uint8_t V=getVForPixel(face,idx);uint8_t t=((uint8_t)floorf(ovBandPhase))&15;bool on=(V==t)||(((V+15)&15)==t);uint8_t h=on?(ovcUse?g_oh:liveParams.hue):(ovcUse?g_oh2:liveParams.hue2);uint8_t s=on?(ovcUse?g_os:liveParams.sat):(ovcUse?g_os2:liveParams.sat2);uint8_t v=on?(ovcUse?g_ov:liveParams.val):(ovcUse?g_ov2:liveParams.val2);return chsvMix(h,s,v);}case PATTERN_CHECKER:{uint8_t V=getVForPixel(face,idx);uint8_t Vb=(uint8_t)((V+(ovcUse?0:liveParams.chkBias))&15);uint8_t st=liveParams.chkStep==0?1:liveParams.chkStep;bool on=((((uint8_t)(Vb/st))&1)==0);uint8_t h=on?(ovcUse?g_oh:liveParams.hue):(ovcUse?g_oh2:liveParams.hue2);uint8_t s=on?(ovcUse?g_os:liveParams.sat):(ovcUse?g_os2:liveParams.sat2);uint8_t v=on?(ovcUse?g_ov:liveParams.val):(ovcUse?g_ov2:liveParams.val2);return chsvMix(h,s,v);}default:{uint8_t V=getVForPixel(face,idx);uint8_t h=(uint8_t)(ovRainbowPhase+V*8);uint8_t v=ovcUse?g_ov:liveParams.val;return chsvMix(h,255,v);}}}
      | ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:99:1: error: 'CRGB' does not name a type
   99 |  CRGB blendModeApply(CRGB base,CRGB ov,uint8_t a,uint8_t mode){uint8_t inv=255-a;switch(mode){case 0:return CRGB((base.r*inv+ov.r*a)/255,(base.g*inv+ov.g*a)/255,(base.b*inv+ov.b*a)/255);case 1:return CRGB(clamp8(base.r+((ov.r*a)/255)),clamp8(base.g+((ov.g*a)/255)),clamp8(base.b+((ov.b*a)/255)));case 2:return CRGB(max(base.r,(uint8_t)((ov.r*a)/255)),max(base.g,(uint8_t)((ov.g*a)/255)),max(base.b,(uint8_t)((ov.b*a)/255)));case 3:return CRGB((base.r*((ov.r*a)/255))/255,(base.g*((ov.g*a)/255))/255,(base.b*((ov.b*a)/255))/255);default:return CRGB(255-(((255-base.r)*(255-((ov.r*a)/255)))/255),255-(((255-base.g)*(255-((ov.g*a)/255)))/255),255-(((255-base.b)*(255-((ov.b*a)/255)))/255));}}
      | ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:102:23: error: 'sensors_event_t' was not declared in this scope
  102 |  uint8_t faceFromAccel(sensors_event_t &acc){const float th=3.5f;if(acc.acceleration.z> th)return 5;if(acc.acceleration.z<-th)return 0;if(acc.acceleration.x> th)return 3;if(acc.acceleration.x<-th)return 1;if(acc.acceleration.y> th)return 2;if(acc.acceleration.y<-th)return 4;return 255;}
      |                       ^~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:102:40: error: 'acc' was not declared in this scope
  102 |  uint8_t faceFromAccel(sensors_event_t &acc){const float th=3.5f;if(acc.acceleration.z> th)return 5;if(acc.acceleration.z<-th)return 0;if(acc.acceleration.x> th)return 3;if(acc.acceleration.x<-th)return 1;if(acc.acceleration.y> th)return 2;if(acc.acceleration.y<-th)return 4;return 255;}
      |                                        ^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:6: error: variable or field 'onWsEvent' declared void
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |      ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:16: error: 'AsyncWebSocket' was not declared in this scope
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                ^~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:31: error: expected primary-expression before ',' token
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                               ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:32: error: 'AsyncWebSocketClient' was not declared in this scope
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                                ^~~~~~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:54: error: 'c' was not declared in this scope
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                                                      ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:56: error: 'AwsEventType' was not declared in this scope
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                                                        ^~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:74: error: expected primary-expression before 'void'
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                                                                          ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:90: error: expected primary-expression before '*' token
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                                                                                          ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:91: error: 'data' was not declared in this scope
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                                                                                           ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:91: note: suggested alternatives:
In file included from C:/Users/keyes/AppData/Local/Arduino15/packages/esp32/tools/esp-x32/2411/xtensa-esp-elf/include/c++/14.2.0/unordered_map:42,
                 from C:/Users/keyes/AppData/Local/Arduino15/packages/esp32/tools/esp-x32/2411/xtensa-esp-elf/include/c++/14.2.0/functional:63,
                 from C:\Users\keyes\AppData\Local\Arduino15\packages\esp32\hardware\esp32\3.3.0\cores\esp32/HardwareSerial.h:49,
                 from C:\Users\keyes\AppData\Local\Arduino15\packages\esp32\hardware\esp32\3.3.0\cores\esp32/Arduino.h:202,
                 from C:\Users\keyes\AppData\Local\arduino\sketches\66949BC2319C026CA17C57682BBFDC99\sketch\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino.cpp:1:
C:/Users/keyes/AppData/Local/Arduino15/packages/esp32/tools/esp-x32/2411/xtensa-esp-elf/include/c++/14.2.0/bits/range_access.h:344:5: note:   'std::data'
  344 |     data(initializer_list<_Tp> __il) noexcept
      |     ^~~~
In file included from C:/Users/keyes/AppData/Local/Arduino15/packages/esp32/tools/esp-x32/2411/xtensa-esp-elf/include/c++/14.2.0/bits/ranges_algobase.h:38,
                 from C:/Users/keyes/AppData/Local/Arduino15/packages/esp32/tools/esp-x32/2411/xtensa-esp-elf/include/c++/14.2.0/bits/ranges_algo.h:38,
                 from C:/Users/keyes/AppData/Local/Arduino15/packages/esp32/tools/esp-x32/2411/xtensa-esp-elf/include/c++/14.2.0/algorithm:63,
                 from C:\Users\keyes\AppData\Local\Arduino15\packages\esp32\hardware\esp32\3.3.0\cores\esp32/Arduino.h:190:
C:/Users/keyes/AppData/Local/Arduino15/packages/esp32/tools/esp-x32/2411/xtensa-esp-elf/include/c++/14.2.0/bits/ranges_base.h:494:46: note:   'std::ranges::_Cpo::data'
  494 |     inline constexpr ranges::__access::_Data data{};
      |                                              ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:103: error: expected primary-expression before 'len'
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      |                                                                                                       ^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void drawSingleColor(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:40:47: error: 'leds' was not declared in this scope
   40 |  void drawSingleColor(uint8_t f) { fill_solid(leds[f], NUM_LEDS_FACE, CHSV(160, 255, 200)); }
      |                                               ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:40:56: error: 'NUM_LEDS_FACE' was not declared in this scope
   40 |  void drawSingleColor(uint8_t f) { fill_solid(leds[f], NUM_LEDS_FACE, CHSV(160, 255, 200)); }
      |                                                        ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:40:71: error: 'CHSV' was not declared in this scope
   40 |  void drawSingleColor(uint8_t f) { fill_solid(leds[f], NUM_LEDS_FACE, CHSV(160, 255, 200)); }
      |                                                                       ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:40:36: error: 'fill_solid' was not declared in this scope
   40 |  void drawSingleColor(uint8_t f) { fill_solid(leds[f], NUM_LEDS_FACE, CHSV(160, 255, 200)); }
      |                                    ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void drawHalfSplit(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:42:29: error: 'NUM_LEDS_FACE' was not declared in this scope
   42 |    for (uint16_t i = 0; i < NUM_LEDS_FACE; i++) {
      |                             ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:43:6: error: 'leds' was not declared in this scope
   43 |      leds[f][i] = (i / PANEL_W < PANEL_H / 2) ? CHSV(0, 255, 255) : CHSV(96, 255, 255);
      |      ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:43:34: error: 'PANEL_H' was not declared in this scope
   43 |      leds[f][i] = (i / PANEL_W < PANEL_H / 2) ? CHSV(0, 255, 255) : CHSV(96, 255, 255);
      |                                  ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:43:24: error: 'PANEL_W' was not declared in this scope
   43 |      leds[f][i] = (i / PANEL_W < PANEL_H / 2) ? CHSV(0, 255, 255) : CHSV(96, 255, 255);
      |                        ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:43:49: error: 'CHSV' was not declared in this scope
   43 |      leds[f][i] = (i / PANEL_W < PANEL_H / 2) ? CHSV(0, 255, 255) : CHSV(96, 255, 255);
      |                                                 ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void drawRandomTwinkle(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:47:29: error: 'NUM_LEDS_FACE' was not declared in this scope
   47 |    for (uint16_t i = 0; i < NUM_LEDS_FACE; i++) {
      |                             ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:48:6: error: 'leds' was not declared in this scope
   48 |      leds[f][i] = random8() < 10 ? CRGB(CHSV(random8(), 255, 255)) : CRGB::Black;
      |      ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:48:19: error: 'random8' was not declared in this scope; did you mean 'random'?
   48 |      leds[f][i] = random8() < 10 ? CRGB(CHSV(random8(), 255, 255)) : CRGB::Black;
      |                   ^~~~~~~
      |                   random
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:48:41: error: 'CHSV' was not declared in this scope
   48 |      leds[f][i] = random8() < 10 ? CRGB(CHSV(random8(), 255, 255)) : CRGB::Black;
      |                                         ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:48:36: error: 'CRGB' was not declared in this scope
   48 |      leds[f][i] = random8() < 10 ? CRGB(CHSV(random8(), 255, 255)) : CRGB::Black;
      |                                    ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:48:70: error: 'CRGB' is not a class, namespace, or enumeration
   48 |      leds[f][i] = random8() < 10 ? CRGB(CHSV(random8(), 255, 255)) : CRGB::Black;
      |                                                                      ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: At global scope:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:52:1: error: expected unqualified-id before '-' token
   52 | -FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:53:1: error: expected unqualified-id before '+' token
   53 | +FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;uint8_t currentRotation=0;
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:53:40: error: redefinition of 'uint8_t brightness'
   53 | +FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;uint8_t currentRotation=0;
      |                                        ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:52:40: note: 'uint8_t brightness' previously defined here
   52 | -FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;
      |                                        ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:53:62: error: redefinition of 'uint8_t gBrightness'
   53 | +FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;uint8_t currentRotation=0;
      |                                                              ^~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:52:62: note: 'uint8_t gBrightness' previously defined here
   52 | -FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;
      |                                                              ^~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:53:78: error: redefinition of 'uint8_t currentFace'
   53 | +FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;uint8_t currentRotation=0;
      |                                                                              ^~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:52:78: note: 'uint8_t currentFace' previously defined here
   52 | -FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;
      |                                                                              ^~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:53:102: error: redefinition of 'Pattern currentPattern'
   53 | +FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;uint8_t currentRotation=0;
      |                                                                                                      ^~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:52:102: note: 'Pattern currentPattern' previously defined here
   52 | -FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;
      |                                                                                                      ^~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:53:138: error: redefinition of 'Params liveParams'
   53 | +FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;uint8_t currentRotation=0;
      |                                                                                                                                          ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:52:138: note: 'Params liveParams' previously declared here
   52 | -FaceConfig faceCfg[NUM_FACES];uint8_t brightness=BRIGHT_MAX,gBrightness=100,currentFace=255;Pattern currentPattern=PATTERN_SOLID;Params liveParams;
      |                                                                                                                                          ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:56:16: error: 'NUM_FACES' was not declared in this scope
   56 |  Step playlist[NUM_FACES][MAX_STEPS];uint8_t plLen[NUM_FACES]={0};bool plLoop[NUM_FACES]={0},plPlay[NUM_FACES]={0};uint8_t plIdx[NUM_FACES]={0};uint32_t plDueMs[NUM_FACES]={0};
      |                ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:56:52: error: 'NUM_FACES' was not declared in this scope
   56 |  Step playlist[NUM_FACES][MAX_STEPS];uint8_t plLen[NUM_FACES]={0};bool plLoop[NUM_FACES]={0},plPlay[NUM_FACES]={0};uint8_t plIdx[NUM_FACES]={0};uint32_t plDueMs[NUM_FACES]={0};
      |                                                    ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:56:79: error: 'NUM_FACES' was not declared in this scope
   56 |  Step playlist[NUM_FACES][MAX_STEPS];uint8_t plLen[NUM_FACES]={0};bool plLoop[NUM_FACES]={0},plPlay[NUM_FACES]={0};uint8_t plIdx[NUM_FACES]={0};uint32_t plDueMs[NUM_FACES]={0};
      |                                                                               ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:56:101: error: 'NUM_FACES' was not declared in this scope
   56 |  Step playlist[NUM_FACES][MAX_STEPS];uint8_t plLen[NUM_FACES]={0};bool plLoop[NUM_FACES]={0},plPlay[NUM_FACES]={0};uint8_t plIdx[NUM_FACES]={0};uint32_t plDueMs[NUM_FACES]={0};
      |                                                                                                     ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:56:130: error: 'NUM_FACES' was not declared in this scope
   56 |  Step playlist[NUM_FACES][MAX_STEPS];uint8_t plLen[NUM_FACES]={0};bool plLoop[NUM_FACES]={0},plPlay[NUM_FACES]={0};uint8_t plIdx[NUM_FACES]={0};uint32_t plDueMs[NUM_FACES]={0};
      |                                                                                                                                  ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:56:162: error: 'NUM_FACES' was not declared in this scope
   56 |  Step playlist[NUM_FACES][MAX_STEPS];uint8_t plLen[NUM_FACES]={0};bool plLoop[NUM_FACES]={0},plPlay[NUM_FACES]={0};uint8_t plIdx[NUM_FACES]={0};uint32_t plDueMs[NUM_FACES]={0};
      |                                                                                                                                                                  ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:57:2: error: 'PresetG' does not name a type
   57 |  PresetG gPresets[MAX_PRESETS];uint8_t gPrLen=0;uint32_t saveDue=0;bool savePending=false;
      |  ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'uint8_t px(uint16_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:58:34: error: 'PANEL_W' was not declared in this scope
   58 |  uint8_t px(uint16_t i){return i%PANEL_W;}uint8_t py(uint16_t i){return i/PANEL_W;}
      |                                  ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'uint8_t py(uint16_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:58:75: error: 'PANEL_W' was not declared in this scope
   58 |  uint8_t px(uint16_t i){return i%PANEL_W;}uint8_t py(uint16_t i){return i/PANEL_W;}
      |                                                                           ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: At global scope:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:63:1: error: expected unqualified-id before '-' token
   63 | -void saveNow(){for(uint8_t f=0;f<NUM_FACES;f++){char key[8];snprintf(key,sizeof(key),"f%u",f);StaticJsonDocument<256>d;d["p"]=(uint8_t)faceCfg[f].pattern;JsonObject pr=d.createNestedObject("r");pr["spd"]=faceCfg[f].params.speed;pr["dir"]=faceCfg[f].params.dirReverse?1:0;pr["h"]=faceCfg[f].params.hue;pr["s"]=faceCfg[f].params.sat;pr["v"]=faceCfg[f].params.val;pr["h2"]=faceCfg[f].params.hue2;pr["s2"]=faceCfg[f].params.sat2;pr["v2"]=faceCfg[f].params.val2;pr["cs"]=faceCfg[f].params.chkStep;pr["cb"]=faceCfg[f].params.chkBias;pr["ci"]=faceCfg[f].params.chkInvert?1:0;String s;serializeJson(d,s);prefs.putString(key,s);}StaticJsonDocument<96> g;g["use"]=ovcUse?1:0;g["h"]=g_oh;g["s"]=g_os;g["v"]=g_ov;g["h2"]=g_oh2;g["s2"]=g_os2;g["v2"]=g_ov2;{String og;serializeJson(g,og);prefs.putString("ovcg",og);}prefs.putUChar("gbr",gBrightness);savePending=false;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:64:1: error: expected unqualified-id before '-' token
   64 | -bool loadFaceFromPrefs(uint8_t f){char key[8];snprintf(key,sizeof(key),"f%u",f);String s=prefs.getString(key,"");if(!s.length())return false;StaticJsonDocument<256>d;if(deserializeJson(d,s))return false;faceCfg[f].pattern=(Pattern)(uint8_t)d["p"];JsonObject pr=d["r"];faceCfg[f].params.speed=pr["spd"]|30;faceCfg[f].params.dirReverse=(pr["dir"]|0)?true:false;faceCfg[f].params.hue=pr["h"]|160;faceCfg[f].params.sat=pr["s"]|255;faceCfg[f].params.val=pr["v"]|200;faceCfg[f].params.hue2=pr["h2"]|0;faceCfg[f].params.sat2=pr["s2"]|0;faceCfg[f].params.val2=pr["v2"]|0;faceCfg[f].params.chkStep=pr["cs"]|4;faceCfg[f].params.chkBias=pr["cb"]|0;faceCfg[f].params.chkInvert=(pr["ci"]|0)?true:false;return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:65:1: error: expected unqualified-id before '-' token
   65 | -void defaultsFace(uint8_t f){faceCfg[f].pattern=PATTERN_SOLID;faceCfg[f].params={30,false,160,255,200,0,0,0,4,0,false};}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:66:1: error: expected unqualified-id before '-' token
   66 | -void applyFaceConfig(uint8_t f){currentPattern=faceCfg[f].pattern;liveParams=faceCfg[f].params;renderDirty=true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:67:1: error: expected unqualified-id before '+' token
   67 | +void saveNow(){for(uint8_t f=0;f<NUM_FACES;f++){char key[8];snprintf(key,sizeof(key),"f%u",f);StaticJsonDocument<256>d;d["p"]=(uint8_t)faceCfg[f].pattern;d["rot"]=faceCfg[f].rotation;JsonObject pr=d.createNestedObject("r");pr["spd"]=faceCfg[f].params.speed;pr["dir"]=faceCfg[f].params.dirReverse?1:0;pr["h"]=faceCfg[f].params.hue;pr["s"]=faceCfg[f].params.sat;pr["v"]=faceCfg[f].params.val;pr["h2"]=faceCfg[f].params.hue2;pr["s2"]=faceCfg[f].params.sat2;pr["v2"]=faceCfg[f].params.val2;pr["cs"]=faceCfg[f].params.chkStep;pr["cb"]=faceCfg[f].params.chkBias;pr["ci"]=faceCfg[f].params.chkInvert?1:0;String s;serializeJson(d,s);prefs.putString(key,s);}StaticJsonDocument<96> g;g["use"]=ovcUse?1:0;g["h"]=g_oh;g["s"]=g_os;g["v"]=g_ov;g["h2"]=g_oh2;g["s2"]=g_os2;g["v2"]=g_ov2;{String og;serializeJson(g,og);prefs.putString("ovcg",og);}prefs.putUChar("gbr",gBrightness);savePending=false;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:68:1: error: expected unqualified-id before '+' token
   68 | +bool loadFaceFromPrefs(uint8_t f){char key[8];snprintf(key,sizeof(key),"f%u",f);String s=prefs.getString(key,"");if(!s.length())return false;StaticJsonDocument<256>d;if(deserializeJson(d,s))return false;faceCfg[f].pattern=(Pattern)(uint8_t)d["p"];faceCfg[f].rotation=d["rot"]|0;JsonObject pr=d["r"];faceCfg[f].params.speed=pr["spd"]|30;faceCfg[f].params.dirReverse=(pr["dir"]|0)?true:false;faceCfg[f].params.hue=pr["h"]|160;faceCfg[f].params.sat=pr["s"]|255;faceCfg[f].params.val=pr["v"]|200;faceCfg[f].params.hue2=pr["h2"]|0;faceCfg[f].params.sat2=pr["s2"]|0;faceCfg[f].params.val2=pr["v2"]|0;faceCfg[f].params.chkStep=pr["cs"]|4;faceCfg[f].params.chkBias=pr["cb"]|0;faceCfg[f].params.chkInvert=(pr["ci"]|0)?true:false;return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:69:1: error: expected unqualified-id before '+' token
   69 | +void defaultsFace(uint8_t f){faceCfg[f].pattern=PATTERN_SOLID;faceCfg[f].params={30,false,160,255,200,0,0,0,4,0,false};faceCfg[f].rotation=0;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:70:1: error: expected unqualified-id before '+' token
   70 | +void applyFaceConfig(uint8_t f){currentPattern=faceCfg[f].pattern;liveParams=faceCfg[f].params;currentRotation=faceCfg[f].rotation;renderDirty=true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void loadOverlayGlobals()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:71:37: error: 'prefs' was not declared in this scope
   71 |  void loadOverlayGlobals(){String s=prefs.getString("ovcg","");if(!s.length())return;StaticJsonDocument<96>d;if(deserializeJson(d,s))return;ovcUse=(d["use"]|0)?true:false;g_oh=d["h"]|160;g_os=d["s"]|255;g_ov=d["v"]|200;g_oh2=d["h2"]|0;g_os2=d["s2"]|0;g_ov2=d["v2"]|0;}
      |                                     ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:71:86: error: 'StaticJsonDocument' was not declared in this scope
   71 |  void loadOverlayGlobals(){String s=prefs.getString("ovcg","");if(!s.length())return;StaticJsonDocument<96>d;if(deserializeJson(d,s))return;ovcUse=(d["use"]|0)?true:false;g_oh=d["h"]|160;g_os=d["s"]|255;g_ov=d["v"]|200;g_oh2=d["h2"]|0;g_os2=d["s2"]|0;g_ov2=d["v2"]|0;}
      |                                                                                      ^~~~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:71:108: error: 'd' was not declared in this scope
   71 |  void loadOverlayGlobals(){String s=prefs.getString("ovcg","");if(!s.length())return;StaticJsonDocument<96>d;if(deserializeJson(d,s))return;ovcUse=(d["use"]|0)?true:false;g_oh=d["h"]|160;g_os=d["s"]|255;g_ov=d["v"]|200;g_oh2=d["h2"]|0;g_os2=d["s2"]|0;g_ov2=d["v2"]|0;}
      |                                                                                                            ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:71:113: error: 'deserializeJson' was not declared in this scope
   71 |  void loadOverlayGlobals(){String s=prefs.getString("ovcg","");if(!s.length())return;StaticJsonDocument<96>d;if(deserializeJson(d,s))return;ovcUse=(d["use"]|0)?true:false;g_oh=d["h"]|160;g_os=d["s"]|255;g_ov=d["v"]|200;g_oh2=d["h2"]|0;g_os2=d["s2"]|0;g_ov2=d["v2"]|0;}
      |                                                                                                                 ^~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void prgStoreCount()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:73:23: error: 'prefs' was not declared in this scope
   73 |  void prgStoreCount(){prefs.putUChar("prN",gPrLen);}
      |                       ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: At global scope:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:74:1: error: expected unqualified-id before '-' token
   74 | -void prgStoreOne(uint8_t i){PresetB b;PresetG &pt=gPresets[i];b.p=pt.p;b.pr=pt.pr;b.ovr=pt.ovr;b.oPat=pt.oPat;b.blend=pt.blend;b.oA=pt.oA;char kb[8];snprintf(kb,sizeof(kb),"pg%u",i);prefs.putBytes(kb,&b,sizeof(b));char kn[8];snprintf(kn,sizeof(kn),"pn%u",i);prefs.putString(kn,pt.name);}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:75:1: error: expected unqualified-id before '-' token
   75 | -bool prgLoadOne(uint8_t i){PresetB b;char kb[8];snprintf(kb,sizeof(kb),"pg%u",i);size_t n=prefs.getBytes(kb,&b,sizeof(b));if(n!=sizeof(b))return false;PresetG &pt=gPresets[i];pt.p=b.p;pt.pr=b.pr;pt.ovr=b.ovr;pt.oPat=b.oPat;pt.blend=b.blend;pt.oA=b.oA;char kn[8];snprintf(kn,sizeof(kn),"pn%u",i);pt.name=prefs.getString(kn,String("Preset ")+String(i+1));return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:76:1: error: expected unqualified-id before '-' token
   76 | -void prgMigrateFromLegacy(){String s=prefs.getString("prG","");if(!s.length())return;StaticJsonDocument<4096>d;if(deserializeJson(d,s))return;uint8_t n=min<uint8_t>((uint8_t)(d["n"]|0),MAX_PRESETS);JsonArray a=d["l"];gPrLen=0;for(JsonObject o:a){if(gPrLen>=n)break;PresetG &pt=gPresets[gPrLen];pt.p=o["p"]|0;pt.pr.speed=o["spd"]|30;pt.pr.dirReverse=(o["dir"]|0)?true:false;pt.pr.hue=o["h"]|160;pt.pr.sat=o["s"]|255;pt.pr.val=o["v"]|200;pt.pr.hue2=o["h2"]|0;pt.pr.sat2=o["s2"]|0;pt.pr.val2=o["v2"]|0;pt.pr.chkStep=o["cs"]|4;pt.pr.chkBias=o["cb"]|0;pt.pr.chkInvert=(o["ci"]|0)?true:false;pt.ovr=o["ovr"]|0;pt.oPat=o["opat"]|1;pt.blend=o["blend"]|0;pt.oA=o["oa"]|128;pt.name=String((const char*)(o["name"]|"Preset"));prgStoreOne(gPrLen);gPrLen++;}prgStoreCount();prefs.remove("prG");}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:77:1: error: expected unqualified-id before '-' token
   77 | -void prgLoad(){uint8_t n=prefs.getUChar("prN",255);if(n==255){gPrLen=0;prgMigrateFromLegacy();return;}gPrLen=min<uint8_t>(n,MAX_PRESETS);for(uint8_t i=0;i<gPrLen;i++){if(!prgLoadOne(i)){gPresets[i].p=0;gPresets[i].pr={30,false,160,255,200,0,0,0,4,0,false};gPresets[i].ovr=0;gPresets[i].oPat=1;gPresets[i].blend=0;gPresets[i].oA=128;gPresets[i].name=String("Preset ")+String(i+1);prgStoreOne(i);}}}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:78:1: error: expected unqualified-id before '-' token
   78 | -void prgBroadcast(){StaticJsonDocument<4096>d;JsonObject pr=d.createNestedObject("presetsG");JsonArray a=pr.createNestedArray("l");for(uint8_t i=0;i<gPrLen;i++){PresetG &pt=gPresets[i];JsonObject o=a.createNestedObject();o["i"]=i;o["name"]=pt.name;o["p"]=pt.p;o["spd"]=pt.pr.speed;o["dir"]=pt.pr.dirReverse?1:0;o["h"]=pt.pr.hue;o["s"]=pt.pr.sat;o["v"]=pt.pr.val;o["h2"]=pt.pr.hue2;o["s2"]=pt.pr.sat2;o["v2"]=pt.pr.val2;o["cs"]=pt.pr.chkStep;o["cb"]=pt.pr.chkBias;o["ci"]=pt.pr.chkInvert?1:0;o["ovr"]=pt.ovr;o["opat"]=pt.oPat;o["blend"]=pt.blend;o["oa"]=pt.oA;}String s;serializeJson(d,s);ws.textAll(s);}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:79:1: error: expected unqualified-id before '-' token
   79 | -bool prgAdd(const String&name){if(gPrLen>=MAX_PRESETS)return false;PresetG &pt=gPresets[gPrLen++];pt.p=(uint8_t)currentPattern;pt.pr=liveParams;pt.ovr=ovrEn?1:0;pt.oPat=(uint8_t)ovrPattern;pt.blend=blendMode;pt.oA=ovrOpacity;pt.name=name.length()?name:String("Preset ")+String(gPrLen);prgStoreOne(gPrLen-1);prgStoreCount();return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:80:1: error: expected unqualified-id before '-' token
   80 | -bool prgApply(uint8_t idx){if(idx>=gPrLen)return false;PresetG &pt=gPresets[idx];currentPattern=(Pattern)pt.p;liveParams=pt.pr;ovrEn=pt.ovr?true:false;ovrPattern=(Pattern)pt.oPat;blendMode=pt.blend;ovrOpacity=pt.oA;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;broadcastState(true);if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;userOverride=true;return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:81:1: error: expected unqualified-id before '+' token
   81 | +void prgStoreOne(uint8_t i){PresetB b;PresetG &pt=gPresets[i];b.p=pt.p;b.pr=pt.pr;b.ovr=pt.ovr;b.oPat=pt.oPat;b.blend=pt.blend;b.oA=pt.oA;for(uint8_t f=0;f<NUM_FACES;f++)b.rot[f]=pt.rot[f];char kb[8];snprintf(kb,sizeof(kb),"pg%u",i);prefs.putBytes(kb,&b,sizeof(b));char kn[8];snprintf(kn,sizeof(kn),"pn%u",i);prefs.putString(kn,pt.name);}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:82:1: error: expected unqualified-id before '+' token
   82 | +bool prgLoadOne(uint8_t i){PresetB b;char kb[8];snprintf(kb,sizeof(kb),"pg%u",i);size_t n=prefs.getBytes(kb,&b,sizeof(b));if(n!=sizeof(b))return false;PresetG &pt=gPresets[i];pt.p=b.p;pt.pr=b.pr;pt.ovr=b.ovr;pt.oPat=b.oPat;pt.blend=b.blend;pt.oA=b.oA;for(uint8_t f=0;f<NUM_FACES;f++)pt.rot[f]=b.rot[f];char kn[8];snprintf(kn,sizeof(kn),"pn%u",i);pt.name=prefs.getString(kn,String("Preset ")+String(i+1));return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:83:1: error: expected unqualified-id before '+' token
   83 | +void prgMigrateFromLegacy(){String s=prefs.getString("prG","");if(!s.length())return;StaticJsonDocument<4096>d;if(deserializeJson(d,s))return;uint8_t n=min<uint8_t>((uint8_t)(d["n"]|0),MAX_PRESETS);JsonArray a=d["l"];gPrLen=0;for(JsonObject o:a){if(gPrLen>=n)break;PresetG &pt=gPresets[gPrLen];pt.p=o["p"]|0;pt.pr.speed=o["spd"]|30;pt.pr.dirReverse=(o["dir"]|0)?true:false;pt.pr.hue=o["h"]|160;pt.pr.sat=o["s"]|255;pt.pr.val=o["v"]|200;pt.pr.hue2=o["h2"]|0;pt.pr.sat2=o["s2"]|0;pt.pr.val2=o["v2"]|0;pt.pr.chkStep=o["cs"]|4;pt.pr.chkBias=o["cb"]|0;pt.pr.chkInvert=(o["ci"]|0)?true:false;pt.ovr=o["ovr"]|0;pt.oPat=o["opat"]|1;pt.blend=o["blend"]|0;pt.oA=o["oa"]|128;for(uint8_t f=0;f<NUM_FACES;f++)pt.rot[f]=0;pt.name=String((const char*)(o["name"]|"Preset"));prgStoreOne(gPrLen);gPrLen++;}prgStoreCount();prefs.remove("prG");}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:84:1: error: expected unqualified-id before '+' token
   84 | +void prgLoad(){uint8_t n=prefs.getUChar("prN",255);if(n==255){gPrLen=0;prgMigrateFromLegacy();return;}gPrLen=min<uint8_t>(n,MAX_PRESETS);for(uint8_t i=0;i<gPrLen;i++){if(!prgLoadOne(i)){gPresets[i].p=0;gPresets[i].pr={30,false,160,255,200,0,0,0,4,0,false};gPresets[i].ovr=0;gPresets[i].oPat=1;gPresets[i].blend=0;gPresets[i].oA=128;for(uint8_t f=0;f<NUM_FACES;f++)gPresets[i].rot[f]=faceCfg[f].rotation;gPresets[i].name=String("Preset ")+String(i+1);prgStoreOne(i);}}}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:85:1: error: expected unqualified-id before '+' token
   85 | +void prgBroadcast(){StaticJsonDocument<4096>d;JsonObject pr=d.createNestedObject("presetsG");JsonArray a=pr.createNestedArray("l");for(uint8_t i=0;i<gPrLen;i++){PresetG &pt=gPresets[i];JsonObject o=a.createNestedObject();o["i"]=i;o["name"]=pt.name;o["p"]=pt.p;o["spd"]=pt.pr.speed;o["dir"]=pt.pr.dirReverse?1:0;o["h"]=pt.pr.hue;o["s"]=pt.pr.sat;o["v"]=pt.pr.val;o["h2"]=pt.pr.hue2;o["s2"]=pt.pr.sat2;o["v2"]=pt.pr.val2;o["cs"]=pt.pr.chkStep;o["cb"]=pt.pr.chkBias;o["ci"]=pt.pr.chkInvert?1:0;o["ovr"]=pt.ovr;o["opat"]=pt.oPat;o["blend"]=pt.blend;o["oa"]=pt.oA;JsonArray r=o.createNestedArray("rot");for(uint8_t f=0;f<NUM_FACES;f++)r.add(pt.rot[f]);}String s;serializeJson(d,s);ws.textAll(s);}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:86:1: error: expected unqualified-id before '+' token
   86 | +bool prgAdd(const String&name){if(gPrLen>=MAX_PRESETS)return false;PresetG &pt=gPresets[gPrLen++];pt.p=(uint8_t)currentPattern;pt.pr=liveParams;pt.ovr=ovrEn?1:0;pt.oPat=(uint8_t)ovrPattern;pt.blend=blendMode;pt.oA=ovrOpacity;for(uint8_t f=0;f<NUM_FACES;f++)pt.rot[f]=faceCfg[f].rotation;pt.name=name.length()?name:String("Preset ")+String(gPrLen);prgStoreOne(gPrLen-1);prgStoreCount();return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:87:1: error: expected unqualified-id before '+' token
   87 | +bool prgApply(uint8_t idx){if(idx>=gPrLen)return false;PresetG &pt=gPresets[idx];currentPattern=(Pattern)pt.p;liveParams=pt.pr;ovrEn=pt.ovr?true:false;ovrPattern=(Pattern)pt.oPat;blendMode=pt.blend;ovrOpacity=pt.oA;for(uint8_t f=0;f<NUM_FACES;f++)faceCfg[f].rotation=pt.rot[f];currentRotation=faceCfg[currentFace].rotation;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;broadcastState(true);if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;userOverride=true;return true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'bool prgDup(uint8_t, const String&)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:88:97: error: 'gPresets' was not declared in this scope
   88 |  bool prgDup(uint8_t idx,const String&newName){if(idx>=gPrLen||gPrLen>=MAX_PRESETS)return false;gPresets[gPrLen]=gPresets[idx];gPresets[gPrLen].name=(newName.length()?newName:(gPresets[idx].name+String(" Copy")));prgStoreOne(gPrLen);gPrLen++;prgStoreCount();return true;}
      |                                                                                                 ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'bool prgRen(uint8_t, const String&)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:89:76: error: 'gPresets' was not declared in this scope
   89 |  bool prgRen(uint8_t idx,const String&newName){if(idx>=gPrLen)return false;gPresets[idx].name=newName;char kn[8];snprintf(kn,sizeof(kn),"pn%u",idx);prefs.putString(kn,newName);return true;}
      |                                                                            ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:89:149: error: 'prefs' was not declared in this scope
   89 |  bool prgRen(uint8_t idx,const String&newName){if(idx>=gPrLen)return false;gPresets[idx].name=newName;char kn[8];snprintf(kn,sizeof(kn),"pn%u",idx);prefs.putString(kn,newName);return true;}
      |                                                                                                                                                     ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'bool prgDel(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:90:89: error: 'gPresets' was not declared in this scope
   90 |  bool prgDel(uint8_t idx){if(idx>=gPrLen)return false;for(uint8_t j=idx+1;j<gPrLen;j++){gPresets[j-1]=gPresets[j];PresetB b;char kbOld[8];snprintf(kbOld,sizeof(kbOld),"pg%u",j);prefs.getBytes(kbOld,&b,sizeof(b));char kbNew[8];snprintf(kbNew,sizeof(kbNew),"pg%u",j-1);prefs.putBytes(kbNew,&b,sizeof(b));char knOld[8];snprintf(knOld,sizeof(knOld),"pn%u",j);String nm=prefs.getString(knOld,"");char knNew[8];snprintf(knNew,sizeof(knNew),"pn%u",j-1);prefs.putString(knNew,nm);}char kb[8];snprintf(kb,sizeof(kb),"pg%u",gPrLen-1);prefs.remove(kb);char kn[8];snprintf(kn,sizeof(kn),"pn%u",gPrLen-1);prefs.remove(kn);gPrLen--;prgStoreCount();return true;}
      |                                                                                         ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:90:115: error: 'PresetB' was not declared in this scope
   90 |  bool prgDel(uint8_t idx){if(idx>=gPrLen)return false;for(uint8_t j=idx+1;j<gPrLen;j++){gPresets[j-1]=gPresets[j];PresetB b;char kbOld[8];snprintf(kbOld,sizeof(kbOld),"pg%u",j);prefs.getBytes(kbOld,&b,sizeof(b));char kbNew[8];snprintf(kbNew,sizeof(kbNew),"pg%u",j-1);prefs.putBytes(kbNew,&b,sizeof(b));char knOld[8];snprintf(knOld,sizeof(knOld),"pn%u",j);String nm=prefs.getString(knOld,"");char knNew[8];snprintf(knNew,sizeof(knNew),"pn%u",j-1);prefs.putString(knNew,nm);}char kb[8];snprintf(kb,sizeof(kb),"pg%u",gPrLen-1);prefs.remove(kb);char kn[8];snprintf(kn,sizeof(kn),"pn%u",gPrLen-1);prefs.remove(kn);gPrLen--;prgStoreCount();return true;}
      |                                                                                                                   ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:90:178: error: 'prefs' was not declared in this scope
   90 |  bool prgDel(uint8_t idx){if(idx>=gPrLen)return false;for(uint8_t j=idx+1;j<gPrLen;j++){gPresets[j-1]=gPresets[j];PresetB b;char kbOld[8];snprintf(kbOld,sizeof(kbOld),"pg%u",j);prefs.getBytes(kbOld,&b,sizeof(b));char kbNew[8];snprintf(kbNew,sizeof(kbNew),"pg%u",j-1);prefs.putBytes(kbNew,&b,sizeof(b));char knOld[8];snprintf(knOld,sizeof(knOld),"pn%u",j);String nm=prefs.getString(knOld,"");char knNew[8];snprintf(knNew,sizeof(knNew),"pn%u",j-1);prefs.putString(knNew,nm);}char kb[8];snprintf(kb,sizeof(kb),"pg%u",gPrLen-1);prefs.remove(kb);char kn[8];snprintf(kn,sizeof(kn),"pn%u",gPrLen-1);prefs.remove(kn);gPrLen--;prgStoreCount();return true;}
      |                                                                                                                                                                                  ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:90:200: error: 'b' was not declared in this scope
   90 |  bool prgDel(uint8_t idx){if(idx>=gPrLen)return false;for(uint8_t j=idx+1;j<gPrLen;j++){gPresets[j-1]=gPresets[j];PresetB b;char kbOld[8];snprintf(kbOld,sizeof(kbOld),"pg%u",j);prefs.getBytes(kbOld,&b,sizeof(b));char kbNew[8];snprintf(kbNew,sizeof(kbNew),"pg%u",j-1);prefs.putBytes(kbNew,&b,sizeof(b));char knOld[8];snprintf(knOld,sizeof(knOld),"pn%u",j);String nm=prefs.getString(knOld,"");char knNew[8];snprintf(knNew,sizeof(knNew),"pn%u",j-1);prefs.putString(knNew,nm);}char kb[8];snprintf(kb,sizeof(kb),"pg%u",gPrLen-1);prefs.remove(kb);char kn[8];snprintf(kn,sizeof(kn),"pn%u",gPrLen-1);prefs.remove(kn);gPrLen--;prgStoreCount();return true;}
      |                                                                                                                                                                                                        ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:90:525: error: 'prefs' was not declared in this scope
   90 |  bool prgDel(uint8_t idx){if(idx>=gPrLen)return false;for(uint8_t j=idx+1;j<gPrLen;j++){gPresets[j-1]=gPresets[j];PresetB b;char kbOld[8];snprintf(kbOld,sizeof(kbOld),"pg%u",j);prefs.getBytes(kbOld,&b,sizeof(b));char kbNew[8];snprintf(kbNew,sizeof(kbNew),"pg%u",j-1);prefs.putBytes(kbNew,&b,sizeof(b));char knOld[8];snprintf(knOld,sizeof(knOld),"pn%u",j);String nm=prefs.getString(knOld,"");char knNew[8];snprintf(knNew,sizeof(knNew),"pn%u",j-1);prefs.putString(knNew,nm);}char kb[8];snprintf(kb,sizeof(kb),"pg%u",gPrLen-1);prefs.remove(kb);char kn[8];snprintf(kn,sizeof(kn),"pn%u",gPrLen-1);prefs.remove(kn);gPrLen--;prgStoreCount();return true;}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void clearPanels()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:91:39: error: 'NUM_FACES' was not declared in this scope
   91 |  void clearPanels(){for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,CRGB::Black);}
      |                                       ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:91:64: error: 'leds' was not declared in this scope
   91 |  void clearPanels(){for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,CRGB::Black);}
      |                                                                ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:91:72: error: 'NUM_LEDS_FACE' was not declared in this scope
   91 |  void clearPanels(){for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,CRGB::Black);}
      |                                                                        ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:91:86: error: 'CRGB' has not been declared
   91 |  void clearPanels(){for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,CRGB::Black);}
      |                                                                                      ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:91:53: error: 'fill_solid' was not declared in this scope
   91 |  void clearPanels(){for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,CRGB::Black);}
      |                                                     ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void drawSolid(uint8_t, uint8_t, uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:92:48: error: 'CHSV' was not declared in this scope
   92 |  void drawSolid(uint8_t h,uint8_t s,uint8_t v){CHSV c(h,s,v);for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,c);}
      |                                                ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:92:80: error: 'NUM_FACES' was not declared in this scope
   92 |  void drawSolid(uint8_t h,uint8_t s,uint8_t v){CHSV c(h,s,v);for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,c);}
      |                                                                                ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:92:105: error: 'leds' was not declared in this scope
   92 |  void drawSolid(uint8_t h,uint8_t s,uint8_t v){CHSV c(h,s,v);for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,c);}
      |                                                                                                         ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:92:113: error: 'NUM_LEDS_FACE' was not declared in this scope
   92 |  void drawSolid(uint8_t h,uint8_t s,uint8_t v){CHSV c(h,s,v);for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,c);}
      |                                                                                                                 ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:92:127: error: 'c' was not declared in this scope
   92 |  void drawSolid(uint8_t h,uint8_t s,uint8_t v){CHSV c(h,s,v);for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,c);}
      |                                                                                                                               ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:92:94: error: 'fill_solid' was not declared in this scope
   92 |  void drawSolid(uint8_t h,uint8_t s,uint8_t v){CHSV c(h,s,v);for(uint8_t f=0;f<NUM_FACES;f++)fill_solid(leds[f],NUM_LEDS_FACE,c);}
      |                                                                                              ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void drawBand(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:93:33: error: 'CHSV' was not declared in this scope
   93 |  void drawBand(uint8_t targetV){CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);leds[f][i]=(V==targetV)?onC:offC;}}
      |                                 ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:93:160: error: 'NUM_FACES' was not declared in this scope
   93 |  void drawBand(uint8_t targetV){CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);leds[f][i]=(V==targetV)?onC:offC;}}
      |                                                                                                                                                                ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:93:193: error: 'NUM_LEDS_FACE' was not declared in this scope
   93 |  void drawBand(uint8_t targetV){CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);leds[f][i]=(V==targetV)?onC:offC;}}
      |                                                                                                                                                                                                 ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:93:240: error: 'leds' was not declared in this scope
   93 |  void drawBand(uint8_t targetV){CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);leds[f][i]=(V==targetV)?onC:offC;}}
      |                                                                                                                                                                                                                                                ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:93:264: error: 'onC' was not declared in this scope
   93 |  void drawBand(uint8_t targetV){CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);leds[f][i]=(V==targetV)?onC:offC;}}
      |                                                                                                                                                                                                                                                                        ^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:93:268: error: 'offC' was not declared in this scope
   93 |  void drawBand(uint8_t targetV){CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);leds[f][i]=(V==targetV)?onC:offC;}}
      |                                                                                                                                                                                                                                                                            ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void drawChecker(uint8_t, uint8_t, bool)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:94:76: error: 'CHSV' was not declared in this scope
   94 |  void drawChecker(uint8_t step,uint8_t bias,bool invert){if(step==0)step=1;CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t Vb=(uint8_t)((V+bias)&15);bool on=((((uint8_t)(Vb/step))&1)==0);if(invert)on=!on;leds[f][i]=on?onC:offC;}}
      |                                                                            ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:94:203: error: 'NUM_FACES' was not declared in this scope
   94 |  void drawChecker(uint8_t step,uint8_t bias,bool invert){if(step==0)step=1;CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t Vb=(uint8_t)((V+bias)&15);bool on=((((uint8_t)(Vb/step))&1)==0);if(invert)on=!on;leds[f][i]=on?onC:offC;}}
      |                                                                                                                                                                                                           ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:94:236: error: 'NUM_LEDS_FACE' was not declared in this scope
   94 |  void drawChecker(uint8_t step,uint8_t bias,bool invert){if(step==0)step=1;CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t Vb=(uint8_t)((V+bias)&15);bool on=((((uint8_t)(Vb/step))&1)==0);if(invert)on=!on;leds[f][i]=on?onC:offC;}}
      |                                                                                                                                                                                                                                            ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:94:372: error: 'leds' was not declared in this scope
   94 |  void drawChecker(uint8_t step,uint8_t bias,bool invert){if(step==0)step=1;CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t Vb=(uint8_t)((V+bias)&15);bool on=((((uint8_t)(Vb/step))&1)==0);if(invert)on=!on;leds[f][i]=on?onC:offC;}}
      |                                                                                                                                                                                                                                                                                                                                                                                    ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:94:386: error: 'onC' was not declared in this scope; did you mean 'on'?
   94 |  void drawChecker(uint8_t step,uint8_t bias,bool invert){if(step==0)step=1;CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t Vb=(uint8_t)((V+bias)&15);bool on=((((uint8_t)(Vb/step))&1)==0);if(invert)on=!on;leds[f][i]=on?onC:offC;}}
      |                                                                                                                                                                                                                                                                                                                                                                                                  ^~~
      |                                                                                                                                                                                                                                                                                                                                                                                                  on
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:94:390: error: 'offC' was not declared in this scope
   94 |  void drawChecker(uint8_t step,uint8_t bias,bool invert){if(step==0)step=1;CHSV onC(liveParams.hue,liveParams.sat,liveParams.val),offC(liveParams.hue2,liveParams.sat2,liveParams.val2);for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t Vb=(uint8_t)((V+bias)&15);bool on=((((uint8_t)(Vb/step))&1)==0);if(invert)on=!on;leds[f][i]=on?onC:offC;}}
      |                                                                                                                                                                                                                                                                                                                                                                                                      ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void drawRainbow(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:95:54: error: 'NUM_FACES' was not declared in this scope
   95 |  void drawRainbow(uint8_t baseHue){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t h=baseHue+(uint8_t)(V*8);leds[f][i]=CHSV(h,255,liveParams.val);}}
      |                                                      ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:95:87: error: 'NUM_LEDS_FACE' was not declared in this scope
   95 |  void drawRainbow(uint8_t baseHue){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t h=baseHue+(uint8_t)(V*8);leds[f][i]=CHSV(h,255,liveParams.val);}}
      |                                                                                       ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:95:167: error: 'leds' was not declared in this scope
   95 |  void drawRainbow(uint8_t baseHue){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t h=baseHue+(uint8_t)(V*8);leds[f][i]=CHSV(h,255,liveParams.val);}}
      |                                                                                                                                                                       ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:95:178: error: 'CHSV' was not declared in this scope
   95 |  void drawRainbow(uint8_t baseHue){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){uint8_t V=getVForPixel(f,i);uint8_t h=baseHue+(uint8_t)(V*8);leds[f][i]=CHSV(h,255,liveParams.val);}}
      |                                                                                                                                                                                  ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: At global scope:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:96:2: error: 'CRGB' does not name a type
   96 |  CRGB chsvMix(uint8_t h,uint8_t s,uint8_t v){return CHSV(h,s,v);}
      |  ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:97:2: error: 'CRGB' does not name a type
   97 |  CRGB overlayPixel(uint8_t face,uint16_t idx){switch(ovrPattern){case PATTERN_SOLID:{uint8_t h=ovcUse?g_oh:liveParams.hue;uint8_t s=ovcUse?g_os:liveParams.sat;uint8_t v=ovcUse?g_ov:liveParams.val;return chsvMix(h,s,v);}case PATTERN_BAND:{uint8_t V=getVForPixel(face,idx);uint8_t t=((uint8_t)floorf(ovBandPhase))&15;bool on=(V==t)||(((V+15)&15)==t);uint8_t h=on?(ovcUse?g_oh:liveParams.hue):(ovcUse?g_oh2:liveParams.hue2);uint8_t s=on?(ovcUse?g_os:liveParams.sat):(ovcUse?g_os2:liveParams.sat2);uint8_t v=on?(ovcUse?g_ov:liveParams.val):(ovcUse?g_ov2:liveParams.val2);return chsvMix(h,s,v);}case PATTERN_CHECKER:{uint8_t V=getVForPixel(face,idx);uint8_t Vb=(uint8_t)((V+(ovcUse?0:liveParams.chkBias))&15);uint8_t st=liveParams.chkStep==0?1:liveParams.chkStep;bool on=((((uint8_t)(Vb/st))&1)==0);uint8_t h=on?(ovcUse?g_oh:liveParams.hue):(ovcUse?g_oh2:liveParams.hue2);uint8_t s=on?(ovcUse?g_os:liveParams.sat):(ovcUse?g_os2:liveParams.sat2);uint8_t v=on?(ovcUse?g_ov:liveParams.val):(ovcUse?g_ov2:liveParams.val2);return chsvMix(h,s,v);}default:{uint8_t V=getVForPixel(face,idx);uint8_t h=(uint8_t)(ovRainbowPhase+V*8);uint8_t v=ovcUse?g_ov:liveParams.val;return chsvMix(h,255,v);}}}
      |  ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:99:2: error: 'CRGB' does not name a type
   99 |  CRGB blendModeApply(CRGB base,CRGB ov,uint8_t a,uint8_t mode){uint8_t inv=255-a;switch(mode){case 0:return CRGB((base.r*inv+ov.r*a)/255,(base.g*inv+ov.g*a)/255,(base.b*inv+ov.b*a)/255);case 1:return CRGB(clamp8(base.r+((ov.r*a)/255)),clamp8(base.g+((ov.g*a)/255)),clamp8(base.b+((ov.b*a)/255)));case 2:return CRGB(max(base.r,(uint8_t)((ov.r*a)/255)),max(base.g,(uint8_t)((ov.g*a)/255)),max(base.b,(uint8_t)((ov.b*a)/255)));case 3:return CRGB((base.r*((ov.r*a)/255))/255,(base.g*((ov.g*a)/255))/255,(base.b*((ov.b*a)/255))/255);default:return CRGB(255-(((255-base.r)*(255-((ov.r*a)/255)))/255),255-(((255-base.g)*(255-((ov.g*a)/255)))/255),255-(((255-base.b)*(255-((ov.b*a)/255)))/255));}}
      |  ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void showPanels()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:100:148: error: 'FastLED' was not declared in this scope
  100 |  void showPanels(){uint8_t eff=(uint8_t)((brightness*(uint16_t)gBrightness)/100);if(liveParams.sat<10&&liveParams.val>200)eff=min<uint8_t>(eff,10);FastLED.setBrightness(eff);FastLED.show();}
      |                                                                                                                                                    ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void renderOnce()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:101:392: error: 'NUM_FACES' was not declared in this scope
  101 |  void renderOnce(){switch(currentPattern){case PATTERN_SOLID:drawSolid(liveParams.hue,liveParams.sat,liveParams.val);break;case PATTERN_BAND:drawBand((uint8_t)floorf(bandPhase)&15);break;case PATTERN_CHECKER:drawChecker(liveParams.chkStep==0?1:liveParams.chkStep,liveParams.chkBias&15,liveParams.chkInvert);break;default:drawRainbow((uint8_t)rainbowPhase);break;}if(ovrEn){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){CRGB ov=overlayPixel(f,i);leds[f][i]=blendModeApply(leds[f][i],ov,ovrOpacity,blendMode);}}showPanels();}
      |                                                                                                                                                                                                                                                                                                                                                                                                        ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:101:425: error: 'NUM_LEDS_FACE' was not declared in this scope
  101 |  void renderOnce(){switch(currentPattern){case PATTERN_SOLID:drawSolid(liveParams.hue,liveParams.sat,liveParams.val);break;case PATTERN_BAND:drawBand((uint8_t)floorf(bandPhase)&15);break;case PATTERN_CHECKER:drawChecker(liveParams.chkStep==0?1:liveParams.chkStep,liveParams.chkBias&15,liveParams.chkInvert);break;default:drawRainbow((uint8_t)rainbowPhase);break;}if(ovrEn){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){CRGB ov=overlayPixel(f,i);leds[f][i]=blendModeApply(leds[f][i],ov,ovrOpacity,blendMode);}}showPanels();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                         ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:101:444: error: 'CRGB' was not declared in this scope
  101 |  void renderOnce(){switch(currentPattern){case PATTERN_SOLID:drawSolid(liveParams.hue,liveParams.sat,liveParams.val);break;case PATTERN_BAND:drawBand((uint8_t)floorf(bandPhase)&15);break;case PATTERN_CHECKER:drawChecker(liveParams.chkStep==0?1:liveParams.chkStep,liveParams.chkBias&15,liveParams.chkInvert);break;default:drawRainbow((uint8_t)rainbowPhase);break;}if(ovrEn){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){CRGB ov=overlayPixel(f,i);leds[f][i]=blendModeApply(leds[f][i],ov,ovrOpacity,blendMode);}}showPanels();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:101:470: error: 'leds' was not declared in this scope
  101 |  void renderOnce(){switch(currentPattern){case PATTERN_SOLID:drawSolid(liveParams.hue,liveParams.sat,liveParams.val);break;case PATTERN_BAND:drawBand((uint8_t)floorf(bandPhase)&15);break;case PATTERN_CHECKER:drawChecker(liveParams.chkStep==0?1:liveParams.chkStep,liveParams.chkBias&15,liveParams.chkInvert);break;default:drawRainbow((uint8_t)rainbowPhase);break;}if(ovrEn){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){CRGB ov=overlayPixel(f,i);leds[f][i]=blendModeApply(leds[f][i],ov,ovrOpacity,blendMode);}}showPanels();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:101:507: error: 'ov' was not declared in this scope
  101 |  void renderOnce(){switch(currentPattern){case PATTERN_SOLID:drawSolid(liveParams.hue,liveParams.sat,liveParams.val);break;case PATTERN_BAND:drawBand((uint8_t)floorf(bandPhase)&15);break;case PATTERN_CHECKER:drawChecker(liveParams.chkStep==0?1:liveParams.chkStep,liveParams.chkBias&15,liveParams.chkInvert);break;default:drawRainbow((uint8_t)rainbowPhase);break;}if(ovrEn){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){CRGB ov=overlayPixel(f,i);leds[f][i]=blendModeApply(leds[f][i],ov,ovrOpacity,blendMode);}}showPanels();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:101:481: error: 'blendModeApply' was not declared in this scope; did you mean 'blendMode'?
  101 |  void renderOnce(){switch(currentPattern){case PATTERN_SOLID:drawSolid(liveParams.hue,liveParams.sat,liveParams.val);break;case PATTERN_BAND:drawBand((uint8_t)floorf(bandPhase)&15);break;case PATTERN_CHECKER:drawChecker(liveParams.chkStep==0?1:liveParams.chkStep,liveParams.chkBias&15,liveParams.chkInvert);break;default:drawRainbow((uint8_t)rainbowPhase);break;}if(ovrEn){for(uint8_t f=0;f<NUM_FACES;f++)for(uint16_t i=0;i<NUM_LEDS_FACE;i++){CRGB ov=overlayPixel(f,i);leds[f][i]=blendModeApply(leds[f][i],ov,ovrOpacity,blendMode);}}showPanels();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^~~~~~~~~~~~~~
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 blendMode
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: At global scope:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:102:10: error: redefinition of 'uint8_t faceFromAccel'
  102 |  uint8_t faceFromAccel(sensors_event_t &acc){const float th=3.5f;if(acc.acceleration.z> th)return 5;if(acc.acceleration.z<-th)return 0;if(acc.acceleration.x> th)return 3;if(acc.acceleration.x<-th)return 1;if(acc.acceleration.y> th)return 2;if(acc.acceleration.y<-th)return 4;return 255;}
      |          ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:102:9: note: 'uint8_t faceFromAccel' previously defined here
  102 |  uint8_t faceFromAccel(sensors_event_t &acc){const float th=3.5f;if(acc.acceleration.z> th)return 5;if(acc.acceleration.z<-th)return 0;if(acc.acceleration.x> th)return 3;if(acc.acceleration.x<-th)return 1;if(acc.acceleration.y> th)return 2;if(acc.acceleration.y<-th)return 4;return 255;}
      |         ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:102:24: error: 'sensors_event_t' was not declared in this scope
  102 |  uint8_t faceFromAccel(sensors_event_t &acc){const float th=3.5f;if(acc.acceleration.z> th)return 5;if(acc.acceleration.z<-th)return 0;if(acc.acceleration.x> th)return 3;if(acc.acceleration.x<-th)return 1;if(acc.acceleration.y> th)return 2;if(acc.acceleration.y<-th)return 4;return 255;}
      |                        ^~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:102:41: error: 'acc' was not declared in this scope
  102 |  uint8_t faceFromAccel(sensors_event_t &acc){const float th=3.5f;if(acc.acceleration.z> th)return 5;if(acc.acceleration.z<-th)return 0;if(acc.acceleration.x> th)return 3;if(acc.acceleration.x<-th)return 1;if(acc.acceleration.y> th)return 2;if(acc.acceleration.y<-th)return 4;return 255;}
      |                                         ^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void plSave(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:105:35: error: 'plLen' was not declared in this scope
  105 |  void plSave(uint8_t f){uint8_t n=plLen[f];size_t sz=2+n*sizeof(StepB);uint8_t*buf=(uint8_t*)malloc(sz);if(!buf)return;buf[0]=n;buf[1]=plLoop[f]?1:0;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)stepToBin(playlist[f][i],b[i]);char k[8];snprintf(k,sizeof(k),"plb%u",f);prefs.putBytes(k,buf,sz);free(buf);}
      |                                   ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:105:136: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  105 |  void plSave(uint8_t f){uint8_t n=plLen[f];size_t sz=2+n*sizeof(StepB);uint8_t*buf=(uint8_t*)malloc(sz);if(!buf)return;buf[0]=n;buf[1]=plLoop[f]?1:0;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)stepToBin(playlist[f][i],b[i]);char k[8];snprintf(k,sizeof(k),"plb%u",f);prefs.putBytes(k,buf,sz);free(buf);}
      |                                                                                                                                        ^~~~~~
      |                                                                                                                                        plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:105:208: error: 'playlist' was not declared in this scope
  105 |  void plSave(uint8_t f){uint8_t n=plLen[f];size_t sz=2+n*sizeof(StepB);uint8_t*buf=(uint8_t*)malloc(sz);if(!buf)return;buf[0]=n;buf[1]=plLoop[f]?1:0;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)stepToBin(playlist[f][i],b[i]);char k[8];snprintf(k,sizeof(k),"plb%u",f);prefs.putBytes(k,buf,sz);free(buf);}
      |                                                                                                                                                                                                                ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:105:271: error: 'prefs' was not declared in this scope
  105 |  void plSave(uint8_t f){uint8_t n=plLen[f];size_t sz=2+n*sizeof(StepB);uint8_t*buf=(uint8_t*)malloc(sz);if(!buf)return;buf[0]=n;buf[1]=plLoop[f]?1:0;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)stepToBin(playlist[f][i],b[i]);char k[8];snprintf(k,sizeof(k),"plb%u",f);prefs.putBytes(k,buf,sz);free(buf);}
      |                                                                                                                                                                                                                                                                               ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'bool plLoadLegacyJSON(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:85: error: 'prefs' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                     ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:123: error: 'plLen' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                           ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:134: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                      ^~~~~~
      |                                                                                                                                      plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:164: error: 'StaticJsonDocument' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                    ^~~~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:188: error: 'd' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                            ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:193: error: 'deserializeJson' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                 ^~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:215: error: 'plLen' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                                       ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:226: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                                                  ^~~~~~
      |                                                                                                                                                                                                                                  plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:256: error: 'plLen' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                                                                                ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:309: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                                                                                                                                     ^~~~~~
      |                                                                                                                                                                                                                                                                                                                     plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:344: error: 'JsonArray' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                                                                                                                                                                        ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:379: error: 'JsonObject' was not declared in this scope
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                                                                                                                                                                                                           ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:106:893: error: expected ')' before ';' token
  106 |  bool plLoadLegacyJSON(uint8_t f){char k[8];snprintf(k,sizeof(k),"pl%u",f);String s=prefs.getString(k,"");if(!s.length()){plLen[f]=0;plLoop[f]=false;return false;}StaticJsonDocument<4096>d;if(deserializeJson(d,s)){plLen[f]=0;plLoop[f]=false;return false;}plLen[f]=min<uint8_t>((uint8_t)(d["n"]|0),MAX_STEPS);plLoop[f]=(d["loop"]|0)?true:false;JsonArray a=d["l"];uint8_t i=0;for(JsonObject o:a){if(i>=plLen[f])break;Step &st=playlist[f][i++];st.kind=o["kind"]|0;st.p=o["p"]|0;st.pr.speed=o["spd"]|30;st.pr.dirReverse=(o["dir"]|0)?true:false;st.pr.hue=o["h"]|160;st.pr.sat=o["s"]|255;st.pr.val=o["v"]|200;st.pr.hue2=o["h2"]|0;st.pr.sat2=o["s2"]|0;st.pr.val2=o["v2"]|0;st.pr.chkStep=o["cs"]|4;st.pr.chkBias=o["cb"]|0;st.pr.chkInvert=(o["ci"]|0)?true:false;st.ovr=o["ovr"]|0;st.oPat=o["opat"]|1;st.blend=o["blend"]|0;st.oA=o["oa"]|128;st.sec=o["sec"]|10;st.pi=o["pi"]|0;}prefs.remove(k);plSave(f);return true;}
      |                                                                                                                                                                                                                                                                                                                                                                                          ~                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             )
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void plLoad(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:95: error: 'prefs' was not declared in this scope
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                               ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:301: error: 'plLen' was not declared in this scope
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                                                                                                                                                                                                                                             ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:312: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                                                                                                                                                                                                                                                        ^~~~~~
      |                                                                                                                                                                                                                                                                                                                        plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:399: error: 'playlist' was not declared in this scope
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                                                                                                                                                                                                                                                                                                                                               ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:444: error: 'plLen' was not declared in this scope
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:455: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^~~~~~
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                       plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:509: error: 'plLen' was not declared in this scope
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:107:520: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  107 |  void plLoad(uint8_t f){char k[8];snprintf(k,sizeof(k),"plb%u",f);size_t needMin=2;size_t got=prefs.getBytesLength(k);if(got>=needMin){uint8_t*buf=(uint8_t*)malloc(got);if(buf){prefs.getBytes(k,buf,got);uint8_t n=buf[0];uint8_t lp=buf[1];size_t expect=2+n*sizeof(StepB);if(got==expect&&n<=MAX_STEPS){plLen[f]=n;plLoop[f]=lp?true:false;StepB*b=(StepB*)(buf+2);for(uint8_t i=0;i<n;i++)binToStep(b[i],playlist[f][i]);free(buf);return;}free(buf);}plLen[f]=0;plLoop[f]=false;return;}if(plLoadLegacyJSON(f))return;plLen[f]=0;plLoop[f]=false;}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^~~~~~
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void plBroadcast(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:30: error: 'StaticJsonDocument' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                              ^~~~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:54: error: 'd' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                      ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:56: error: 'JsonObject' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                        ^~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:97: error: 'pl' was not declared in this scope; did you mean 'py'?
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                 ^~
      |                                                                                                 py
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:121: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                         ^~~~~~
      |                                                                                                                         plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:146: error: 'plPlay' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                  ^~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:160: error: 'JsonArray' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                                ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:216: error: 'plLen' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                                                                                        ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:237: error: 'playlist' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                                                                                                             ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:262: error: expected ';' before 'o'
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                                                                                                                                      ^~
      |                                                                                                                                                                                                                                                                      ;
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:288: error: 'o' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                                                                                                                                                                ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:638: error: 'serializeJson' was not declared in this scope
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:108:657: error: 'ws' was not declared in this scope; did you mean 's'?
  108 |  void plBroadcast(uint8_t f){StaticJsonDocument<4096>d;JsonObject pl=d.createNestedObject("pl");pl["face"]=f;pl["loop"]=plLoop[f]?1:0;pl["play"]=plPlay[f]?1:0;JsonArray a=pl.createNestedArray("l");for(uint8_t i=0;i<plLen[f];i++){Step&s=playlist[f][i];JsonObject o=a.createNestedObject();o["kind"]=s.kind;o["p"]=s.p;o["spd"]=s.pr.speed;o["dir"]=s.pr.dirReverse?1:0;o["h"]=s.pr.hue;o["s"]=s.pr.sat;o["v"]=s.pr.val;o["h2"]=s.pr.hue2;o["s2"]=s.pr.sat2;o["v2"]=s.pr.val2;o["cs"]=s.pr.chkStep;o["cb"]=s.pr.chkBias;o["ci"]=s.pr.chkInvert?1:0;o["ovr"]=s.ovr;o["opat"]=s.oPat;o["blend"]=s.blend;o["oa"]=s.oA;o["sec"]=s.sec;o["pi"]=s.pi;}String s;serializeJson(d,s);ws.textAll(s);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^~
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 s
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: At global scope:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:109:1: error: expected unqualified-id before '-' token
  109 | -void plApplyStep(uint8_t f,uint8_t i){if(i>=plLen[f])return;Step &st=playlist[f][i];if(st.kind==1){if(st.pi<gPrLen){PresetG &pt=gPresets[st.pi];currentPattern=(Pattern)pt.p;liveParams=pt.pr;ovrEn=pt.ovr?true:false;ovrPattern=(Pattern)pt.oPat;blendMode=pt.blend;ovrOpacity=pt.oA;}else{currentPattern=(Pattern)st.p;liveParams=st.pr;ovrEn=st.ovr?true:false;ovrPattern=(Pattern)st.oPat;blendMode=st.blend;ovrOpacity=st.oA;}}else{currentPattern=(Pattern)st.p;liveParams=st.pr;ovrEn=st.ovr?true:false;ovrPattern=(Pattern)st.oPat;blendMode=st.blend;ovrOpacity=st.oA;}renderDirty=true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:110:1: error: expected unqualified-id before '+' token
  110 | +void plApplyStep(uint8_t f,uint8_t i){if(i>=plLen[f])return;Step &st=playlist[f][i];if(st.kind==1){if(st.pi<gPrLen){PresetG &pt=gPresets[st.pi];currentPattern=(Pattern)pt.p;liveParams=pt.pr;ovrEn=pt.ovr?true:false;ovrPattern=(Pattern)pt.oPat;blendMode=pt.blend;ovrOpacity=pt.oA;for(uint8_t ff=0;ff<NUM_FACES;ff++)faceCfg[ff].rotation=pt.rot[ff];currentRotation=faceCfg[currentFace].rotation;}else{currentPattern=(Pattern)st.p;liveParams=st.pr;ovrEn=st.ovr?true:false;ovrPattern=(Pattern)st.oPat;blendMode=st.blend;ovrOpacity=st.oA;}}else{currentPattern=(Pattern)st.p;liveParams=st.pr;ovrEn=st.ovr?true:false;ovrPattern=(Pattern)st.oPat;blendMode=st.blend;ovrOpacity=st.oA;}faceCfg[f].pattern=currentPattern;faceCfg[f].params=liveParams;scheduleSave();broadcastState(true);renderDirty=true;}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void plStart(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:111:29: error: 'plLen' was not declared in this scope
  111 |  void plStart(uint8_t f){if(plLen[f]==0)return;plPlay[f]=true;plIdx[f]=0;plApplyStep(f,0);plDueMs[f]=millis()+((uint32_t)playlist[f][0].sec*1000);}
      |                             ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:111:48: error: 'plPlay' was not declared in this scope
  111 |  void plStart(uint8_t f){if(plLen[f]==0)return;plPlay[f]=true;plIdx[f]=0;plApplyStep(f,0);plDueMs[f]=millis()+((uint32_t)playlist[f][0].sec*1000);}
      |                                                ^~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:111:63: error: 'plIdx' was not declared in this scope
  111 |  void plStart(uint8_t f){if(plLen[f]==0)return;plPlay[f]=true;plIdx[f]=0;plApplyStep(f,0);plDueMs[f]=millis()+((uint32_t)playlist[f][0].sec*1000);}
      |                                                               ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:111:91: error: 'plDueMs' was not declared in this scope
  111 |  void plStart(uint8_t f){if(plLen[f]==0)return;plPlay[f]=true;plIdx[f]=0;plApplyStep(f,0);plDueMs[f]=millis()+((uint32_t)playlist[f][0].sec*1000);}
      |                                                                                           ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:111:122: error: 'playlist' was not declared in this scope
  111 |  void plStart(uint8_t f){if(plLen[f]==0)return;plPlay[f]=true;plIdx[f]=0;plApplyStep(f,0);plDueMs[f]=millis()+((uint32_t)playlist[f][0].sec*1000);}
      |                                                                                                                          ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void plStop(uint8_t)':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:112:25: error: 'plPlay' was not declared in this scope
  112 |  void plStop(uint8_t f){plPlay[f]=false;}
      |                         ^~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: At global scope:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:113:1: error: expected unqualified-id before '-' token
  113 | -void broadcastState(bool includeParams){StaticJsonDocument<512>d;JsonObject st=d.createNestedObject("state");st["brightness"]=brightness;st["gbr"]=gBrightness;st["face"]=currentFace;st["pattern_idx"]=(uint8_t)currentPattern;st["ovr"]=ovrEn?1:0;st["ovr_idx"]=(uint8_t)ovrPattern;st["blend_idx"]=blendMode;st["ovrA"]=ovrOpacity;st["ovrSpd"]=ovrSpeed;JsonObject o=d.createNestedObject("ovc");o["use"]=ovcUse?1:0;o["h"]=g_oh;o["s"]=g_os;o["v"]=g_ov;o["h2"]=g_oh2;o["s2"]=g_os2;o["v2"]=g_ov2;if(includeParams){JsonObject p=d.createNestedObject("params");p["speed"]=liveParams.speed;p["reverse"]=liveParams.dirReverse?1:0;p["hue"]=liveParams.hue;p["sat"]=liveParams.sat;p["val"]=liveParams.val;p["hue2"]=liveParams.hue2;p["sat2"]=liveParams.sat2;p["val2"]=liveParams.val2;p["chkStep"]=liveParams.chkStep;p["chkBias"]=liveParams.chkBias;p["chkInvert"]=liveParams.chkInvert?1:0;}String s;serializeJson(d,s);ws.textAll(s);}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:114:1: error: expected unqualified-id before '+' token
  114 | +void broadcastState(bool includeParams){StaticJsonDocument<512>d;JsonObject st=d.createNestedObject("state");st["brightness"]=brightness;st["gbr"]=gBrightness;st["face"]=currentFace;JsonArray r=st.createNestedArray("rot");for(uint8_t i=0;i<NUM_FACES;i++)r.add(faceCfg[i].rotation);st["pattern_idx"]=(uint8_t)currentPattern;st["ovr"]=ovrEn?1:0;st["ovr_idx"]=(uint8_t)ovrPattern;st["blend_idx"]=blendMode;st["ovrA"]=ovrOpacity;st["ovrSpd"]=ovrSpeed;JsonObject o=d.createNestedObject("ovc");o["use"]=ovcUse?1:0;o["h"]=g_oh;o["s"]=g_os;o["v"]=g_ov;o["h2"]=g_oh2;o["s2"]=g_os2;o["v2"]=g_ov2;if(includeParams){JsonObject p=d.createNestedObject("params");p["speed"]=liveParams.speed;p["reverse"]=liveParams.dirReverse?1:0;p["hue"]=liveParams.hue;p["sat"]=liveParams.sat;p["val"]=liveParams.val;p["hue2"]=liveParams.hue2;p["sat2"]=liveParams.sat2;p["val2"]=liveParams.val2;p["chkStep"]=liveParams.chkStep;p["chkBias"]=liveParams.chkBias;p["chkInvert"]=liveParams.chkInvert?1:0;}String s;serializeJson(d,s);ws.textAll(s);}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:116:1: error: expected unqualified-id before '-' token
  116 | -void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false}};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:117:1: error: expected unqualified-id before '+' token
  117 | +void onWsEvent(AsyncWebSocket*,AsyncWebSocketClient* c,AwsEventType type,void*arg,uint8_t*data,size_t len){if(type==WS_EVT_CONNECT){broadcastState(true);prgBroadcast();if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(type!=WS_EVT_DATA)return;AwsFrameInfo*info=(AwsFrameInfo*)arg;if(!(info->final&&info->index==0&&info->len==len&&info->opcode==WS_TEXT))return;StaticJsonDocument<1600> doc;if(deserializeJson(doc,data,len))return;const char*cmd=doc["cmd"]|"";uint32_t now=millis();faceHoldUntilMs=now+FACE_HOLD_MS;if(!strcmp(cmd,"ping")){return;}auto stopPL=[&](){if(currentFace<NUM_FACES&&plPlay[currentFace])plPlay[currentFace]=false;};if(!strcmp(cmd,"pattern_idx")){uint8_t v=(uint8_t)(doc["v"]|0);if(v>6)v=0;currentPattern=(Pattern)v;faceCfg[currentFace].pattern=currentPattern;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"overlay")){if(doc.containsKey("en"))ovrEn=(doc["en"]|0)?true:false;if(doc.containsKey("pat")){uint8_t v=(uint8_t)(doc["pat"]|1);if(v>6)v=1;ovrPattern=(Pattern)v;ovrEn=true;}if(doc.containsKey("blendIdx")){uint8_t v=(uint8_t)(doc["blendIdx"]|0);if(v>4)v=0;blendMode=v;ovrEn=true;}if(doc.containsKey("a"))ovrOpacity=(uint8_t)constrain((int)doc["a"],0,255);if(doc.containsKey("speed"))ovrSpeed=(uint8_t)constrain((int)doc["speed"],1,100);renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"ovcMode")){uint8_t v=(uint8_t)(doc["v"]|0);ovcUse=(v?true:false);saveOverlayGlobals();renderDirty=true;broadcastState(false);stopPL();userOverride=true;return;}if(!strcmp(cmd,"ovc")){const char*k=doc["k"]|"";int v=doc["v"]|0;if(!strcmp(k,"h"))g_oh=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s"))g_os=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v"))g_ov=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"h2"))g_oh2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"s2"))g_os2=(uint8_t)constrain(v,0,255);else if(!strcmp(k,"v2"))g_ov2=(uint8_t)constrain(v,0,255);saveOverlayGlobals();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"param")){const char*k=doc["k"]|"";int vInt=doc["v"]|0;if(!strcmp(k,"speed")){liveParams.speed=(uint8_t)constrain(vInt,1,100);}else if(!strcmp(k,"reverse")){liveParams.dirReverse=(vInt?true:false);}else if(!strcmp(k,"brightness")){brightness=(uint8_t)constrain(vInt,BRIGHT_MIN,BRIGHT_MAX);}else if(!strcmp(k,"gbr")){gBrightness=(uint8_t)constrain(vInt,10,100);prefs.putUChar("gbr",gBrightness);}else if(!strcmp(k,"hue")){liveParams.hue=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat")){liveParams.sat=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val")){liveParams.val=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"hue2")){liveParams.hue2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"sat2")){liveParams.sat2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"val2")){liveParams.val2=(uint8_t)constrain(vInt,0,255);}else if(!strcmp(k,"chkStep")){liveParams.chkStep=(uint8_t)constrain(vInt,1,16);}else if(!strcmp(k,"chkBias")){liveParams.chkBias=(uint8_t)constrain(vInt,0,15);}else if(!strcmp(k,"chkInvert")){liveParams.chkInvert=(vInt?true:false);}faceCfg[currentFace].params=liveParams;scheduleSave();renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"rot")){uint8_t v=(uint8_t)(doc["v"]|0);faceCfg[currentFace].rotation=v;currentRotation=v;scheduleSave();renderDirty=true;stopPL();userOverride=true;broadcastState(false);return;}if(!strcmp(cmd,"defaults")){faceCfg[currentFace]=FaceConfig{PATTERN_SOLID,{30,false,160,255,200,0,0,0,4,0,false},0};applyFaceConfig(currentFace);scheduleSave();broadcastState(true);renderDirty=true;stopPL();userOverride=true;return;}if(!strcmp(cmd,"pl_fetch")){if(currentFace<NUM_FACES)plBroadcast(currentFace);return;}if(!strcmp(cmd,"pl_add")){uint16_t sec=(uint16_t)(doc["sec"]|10);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=0;st.p=(uint8_t)currentPattern;st.pr=liveParams;st.ovr=ovrEn?1:0;st.oPat=(uint8_t)ovrPattern;st.blend=blendMode;st.oA=ovrOpacity;st.sec=sec;st.pi=0;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_add_preset")){uint16_t sec=(uint16_t)(doc["sec"]|10);uint8_t pi=(uint8_t)(doc["pi"]|0);if(currentFace<NUM_FACES&&plLen[currentFace]<MAX_STEPS){Step st;st.kind=1;st.p=0;st.pr=liveParams;st.ovr=0;st.oPat=1;st.blend=0;st.oA=128;st.sec=sec;st.pi=pi;playlist[currentFace][plLen[currentFace]++]=st;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_del")){int i=doc["i"]|0;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]){for(int j=i+1;j<plLen[currentFace];j++)playlist[currentFace][j-1]=playlist[currentFace][j];plLen[currentFace]--;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_move")){int i=doc["i"]|0;int dir=doc["dir"]|0;int j=i+dir;if(currentFace<NUM_FACES&&i>=0&&i<plLen[currentFace]&&j>=0&&j<plLen[currentFace]){Step tmp=playlist[currentFace][i];playlist[currentFace][i]=playlist[currentFace][j];playlist[currentFace][j]=tmp;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_loop")){if(currentFace<NUM_FACES){plLoop[currentFace]=(doc["v"]|0)?true:false;plSave(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_play")){userOverride=false;if(currentFace<NUM_FACES){plStart(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"pl_stop")){userOverride=true;if(currentFace<NUM_FACES){plStop(currentFace);plBroadcast(currentFace);}return;}if(!strcmp(cmd,"prg_list")){prgBroadcast();return;}if(!strcmp(cmd,"prg_save")){const char*nm=doc["name"]|"";prgAdd(String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_apply")){int i=doc["i"]|0;prgApply((uint8_t)i);return;}if(!strcmp(cmd,"prg_dup")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgDup((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_ren")){int i=doc["i"]|0;const char*nm=doc["name"]|"";prgRen((uint8_t)i,String(nm));prgBroadcast();return;}if(!strcmp(cmd,"prg_del")){int i=doc["i"]|0;prgDel((uint8_t)i);prgBroadcast();return;}}
      | ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void initPanels()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:118:20: error: 'FastLED' was not declared in this scope
  118 |  void initPanels(){FastLED.addLeds<WS2812B,PIN_FACE0,GRB>(leds[0],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE1,GRB>(leds[1],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE2,GRB>(leds[2],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE3,GRB>(leds[3],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE4,GRB>(leds[4],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE5,GRB>(leds[5],NUM_LEDS_FACE);FastLED.setCorrection(TypicalLEDStrip);FastLED.setBrightness(BRIGHT_MAX);clearPanels();FastLED.show();}
      |                    ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:118:36: error: 'WS2812B' was not declared in this scope
  118 |  void initPanels(){FastLED.addLeds<WS2812B,PIN_FACE0,GRB>(leds[0],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE1,GRB>(leds[1],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE2,GRB>(leds[2],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE3,GRB>(leds[3],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE4,GRB>(leds[4],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE5,GRB>(leds[5],NUM_LEDS_FACE);FastLED.setCorrection(TypicalLEDStrip);FastLED.setBrightness(BRIGHT_MAX);clearPanels();FastLED.show();}
      |                                    ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:118:44: error: 'PIN_FACE0' was not declared in this scope; did you mean 'PIN_FACE3'?
  118 |  void initPanels(){FastLED.addLeds<WS2812B,PIN_FACE0,GRB>(leds[0],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE1,GRB>(leds[1],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE2,GRB>(leds[2],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE3,GRB>(leds[3],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE4,GRB>(leds[4],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE5,GRB>(leds[5],NUM_LEDS_FACE);FastLED.setCorrection(TypicalLEDStrip);FastLED.setBrightness(BRIGHT_MAX);clearPanels();FastLED.show();}
      |                                            ^~~~~~~~~
      |                                            PIN_FACE3
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:118:54: error: 'GRB' was not declared in this scope
  118 |  void initPanels(){FastLED.addLeds<WS2812B,PIN_FACE0,GRB>(leds[0],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE1,GRB>(leds[1],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE2,GRB>(leds[2],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE3,GRB>(leds[3],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE4,GRB>(leds[4],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE5,GRB>(leds[5],NUM_LEDS_FACE);FastLED.setCorrection(TypicalLEDStrip);FastLED.setBrightness(BRIGHT_MAX);clearPanels();FastLED.show();}
      |                                                      ^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:118:59: error: 'leds' was not declared in this scope
  118 |  void initPanels(){FastLED.addLeds<WS2812B,PIN_FACE0,GRB>(leds[0],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE1,GRB>(leds[1],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE2,GRB>(leds[2],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE3,GRB>(leds[3],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE4,GRB>(leds[4],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE5,GRB>(leds[5],NUM_LEDS_FACE);FastLED.setCorrection(TypicalLEDStrip);FastLED.setBrightness(BRIGHT_MAX);clearPanels();FastLED.show();}
      |                                                           ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:118:67: error: 'NUM_LEDS_FACE' was not declared in this scope
  118 |  void initPanels(){FastLED.addLeds<WS2812B,PIN_FACE0,GRB>(leds[0],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE1,GRB>(leds[1],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE2,GRB>(leds[2],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE3,GRB>(leds[3],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE4,GRB>(leds[4],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE5,GRB>(leds[5],NUM_LEDS_FACE);FastLED.setCorrection(TypicalLEDStrip);FastLED.setBrightness(BRIGHT_MAX);clearPanels();FastLED.show();}
      |                                                                   ^~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:118:414: error: 'TypicalLEDStrip' was not declared in this scope
  118 |  void initPanels(){FastLED.addLeds<WS2812B,PIN_FACE0,GRB>(leds[0],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE1,GRB>(leds[1],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE2,GRB>(leds[2],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE3,GRB>(leds[3],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE4,GRB>(leds[4],NUM_LEDS_FACE);FastLED.addLeds<WS2812B,PIN_FACE5,GRB>(leds[5],NUM_LEDS_FACE);FastLED.setCorrection(TypicalLEDStrip);FastLED.setBrightness(BRIGHT_MAX);clearPanels();FastLED.show();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                              ^~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void setup()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:15: error: 'Wire' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |               ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:39: error: 'mpu' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                       ^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:87: error: 'MPU6050_RANGE_8_G' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                       ^~~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:129: error: 'MPU6050_BAND_21_HZ' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                 ^~~~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:150: error: 'prefs' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                      ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:217: error: 'NUM_FACES' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                         ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:307: error: 'WiFi' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                   ^~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:361: error: 'WIFI_AP' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                         ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:574: error: 'server' was not declared in this scope; did you mean 'Server'?
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^~~~~~
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Server
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:588: error: 'HTTP_GET' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:600: error: 'AsyncWebServerRequest' has not been declared
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^~~~~~~~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In lambda function:
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:632: error: request for member 'send_P' in '* req', which is of non-class type 'int'
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void setup()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:688: error: 'ws' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:699: error: 'onWsEvent' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:733: error: 'DefaultHeaders' has not been declared
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:820: error: 'sensors_event_t' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:880: error: 'a' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:883: error: 'g' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:886: error: 't' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:904: error: 'faceFromAccel' cannot be used as a function
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ~~~~~~~~~~~~~^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:924: error: 'NUM_FACES' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:971: error: 'plLen' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:119:1125: error: 'faceCfg' was not declared in this scope
  119 |  void setup(){Wire.begin(21,22);imuOK=mpu.begin();if(imuOK){mpu.setAccelerometerRange(MPU6050_RANGE_8_G);mpu.setFilterBandwidth(MPU6050_BAND_21_HZ);}prefs.begin("cubert",false);loadOverlayGlobals();for(uint8_t f=0;f<NUM_FACES;f++){if(!loadFaceFromPrefs(f))defaultsFace(f);plLoad(f);}prgLoad();initPanels();WiFi.persistent(false);WiFi.setSleep(false);WiFi.mode(WIFI_AP);IPAddress apIP(192,168,4,1),gw(192,168,4,1),msk(255,255,255,0);WiFi.softAPConfig(apIP,gw,msk);if(AP_PASS&&strlen(AP_PASS)>0)WiFi.softAP(AP_SSID,AP_PASS,6,false,4);else WiFi.softAP(AP_SSID,NULL,6,false,4);server.on("/",HTTP_GET,[](AsyncWebServerRequest*req){req->send_P(200,"text/html; charset=utf-8",INDEX_HTML_V2);});ws.onEvent(onWsEvent);server.addHandler(&ws);DefaultHeaders::Instance().addHeader("Access-Control-Allow-Origin","*");server.begin();sensors_event_t a,g,t;uint8_t f=255;if(imuOK){mpu.getEvent(&a,&g,&t);f=faceFromAccel(a);}currentFace=(f<NUM_FACES)?f:0;applyFaceConfig(currentFace);if(plLen[currentFace]>0){plStart(currentFace);userOverride=false;}else{currentPattern=PATTERN_SOLID;liveParams.hue=192;liveParams.sat=255;liveParams.val=200;faceCfg[currentFace].pattern=currentPattern;faceCfg[currentFace].params=liveParams;scheduleSave();userOverride=true;}lastAnimMs=millis();nextFrameMs=millis();broadcastState(true);plBroadcast(currentFace);prgBroadcast();}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino: In function 'void loop()':
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:68: error: 'sensors_event_t' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                    ^~~~~~~~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:90: error: 'mpu' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                          ^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:104: error: 'a' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                        ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:107: error: 'g' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                           ^
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:110: error: 't' was not declared in this scope; did you mean 'tm'?
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                              ^
      |                                                                                                              tm
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:136: error: 'faceFromAccel' cannot be used as a function
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                           ~~~~~~~~~~~~~^~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:229: error: 'NUM_FACES' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                     ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:288: error: 'NUM_FACES' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:377: error: 'plLen' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                         ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:845: error: 'NUM_FACES' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^~~~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:856: error: 'plPlay' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:885: error: 'plDueMs' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^~~~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:907: error: 'plIdx' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:951: error: 'plLen' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^~~~~
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:974: error: 'plLoop' was not declared in this scope; did you mean 'plStop'?
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^~~~~~
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              plStop
C:\Users\keyes\Downloads\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL\CHATTYBsketch_aug19a_PATTERNS_UI_FIXED_REFRESH_FINAL.ino:120:1132: error: 'playlist' was not declared in this scope
  120 |  void loop(){if(savePending&&millis()>=saveDue)saveNow();if(imuOK){sensors_event_t a,g,t;mpu.getEvent(&a,&g,&t);uint8_t f=faceFromAccel(a);uint32_t now=millis();if(f!=255&&now>=faceHoldUntilMs){if(f!=currentFace){if(currentFace<NUM_FACES)plStop(currentFace);currentFace=f;if(currentFace<NUM_FACES){applyFaceConfig(currentFace);broadcastState(true);plBroadcast(currentFace);if(plLen[currentFace]>0&&!userOverride)plStart(currentFace);}}}}uint32_t now=millis(),dt=now-lastAnimMs;lastAnimMs=now;float sn=liveParams.speed/100.0f;float vps=0.02f+powf(sn,2.2f)*8.0f;float dir=liveParams.dirReverse?-1.0f:1.0f;bandPhase+=dir*vps*(dt/1000.0f)*16.0f;rainbowPhase+=dir*vps*(dt/1000.0f)*256.0f;float ovsn=ovrSpeed/100.0f;float ovvps=0.02f+powf(ovsn,2.2f)*8.0f;ovBandPhase+=ovvps*(dt/1000.0f)*16.0f;ovRainbowPhase+=ovvps*(dt/1000.0f)*256.0f;if(currentFace<NUM_FACES&&plPlay[currentFace]){if(now>=plDueMs[currentFace]){plIdx[currentFace]++;if(plIdx[currentFace]>=plLen[currentFace]){if(plLoop[currentFace])plIdx[currentFace]=0;else{plStop(currentFace);goto skip;}}plApplyStep(currentFace,plIdx[currentFace]);plDueMs[currentFace]=now+((uint32_t)playlist[currentFace][plIdx[currentFace]].sec*1000);renderDirty=true;}}{bool anim=(currentPattern==PATTERN_BAND||currentPattern==PATTERN_RAINBOW||ovrEn);if(anim)renderDirty=true;}skip:if(renderDirty&&now>=nextFrameMs){renderDirty=false;nextFrameMs=now+FRAME_MS;renderOnce();}delay(1);}
      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ^~~~~~~~
exit status 1

Compilation error: stray '@' in program
